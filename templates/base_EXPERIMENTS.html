{% extends 'base.html' %}

{% block content %}

<nav class="navbar navbar-sub">
    <div class="container">
        <ul class="nav navbar-nav">
            <li><a href="{% url 'recommended_experiments' %}">Recommended experiments <span id="recommended_counts" class="badge">{{experiment_counts.recommended_experiment_counts}}</span></a></li>
            <li><a href="{% url 'favorite_experiments' %}">Favorite experiments <span id="favorite_counts" class="badge">{{experiment_counts.favorite_experiment_counts}}</span></a></li>
            <li><a href="{% url 'personal_experiments' %}">Personal experiments <span id="personal_counts" class="badge">{{experiment_counts.personal_experiment_counts}}</span></a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li><a href="{% url 'create_experiment' %}"><span class="glyphicon glyphicon-plus"></span> Add new experiment</a></li>
        </ul>
    </div>
</nav>

<div class="container container-fluid">
    <div class="accordion" id="filterForm">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#filterForm" href="#EndpointForm" title="Filter endpoints">
                Filter experiments
                </a>
            </div>
            <div id="EndpointForm" class="accordion-body collapse">
                <div class="accordion-inner container-fluid">
                    <form action="." method="get">
                        <fieldset>
                            {{ form.non_field_errors}}

                            {% for field in form %}   

                                {% if forloop.counter0|divisibleby:4 %}
                                    <div class="row-fluid">
                                {% endif %}

                                <div class="span3">
                                    {{field.label_tag}}
                                    <div class="controls">
                                        {{field}}<br>
                                        <span class='help-inline'>{{field.help_text}}</span>
                                    </div>
                                    {{field.errors}}
                                </div>

                                {% if forloop.counter0|add:1|divisibleby:4 %}
                                    </div>
                                {% endif %}

                            {% endfor %}
                        </fieldset>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">Apply filters</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div id="processing_container"></div>
    <div id="experiment_container"></div>

    {% if is_paginated %}
        <div class="pagination">
            <span class="page-links">
                {% if page_obj.has_previous %}
                    <a href="?page={{ page_obj.previous_page_number }}">previous</a>
                {% endif %}
                <span class="page-current">
                    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
                </span>
                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}">next</a>
                {% endif %}
            </span>
        </div>
    {% endif %}

</div>

{% endblock content %}
